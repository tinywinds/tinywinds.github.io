
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tinywind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Tinywind">
<meta property="og:url" content="http://tinywind.cn/page/2/index.html">
<meta property="og:site_name" content="Tinywind">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Nathan">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Tinywind" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 4.2.1"></head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tinywind</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="tinywind.cn">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main">
  
    <article id="post-multi-languages-site-seo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/12/multi-languages-site-seo/" class="article-date">
  <time datetime="2018-12-12T05:52:20.000Z" itemprop="datePublished">2018-12-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/12/multi-languages-site-seo/">多语言多区域网站SEO的快速入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="International-SEO：多语言多区域网站SEO的快速入门指南"><a href="#International-SEO：多语言多区域网站SEO的快速入门指南" class="headerlink" title="International SEO：多语言多区域网站SEO的快速入门指南"></a>International SEO：多语言多区域网站SEO的快速入门指南</h1><p>随着经济全球化的不断发展，我们的用户受众不再仅仅是当地国家，多语言多区域的网站、平台越来越多。如果您有一个或多个以多种语言面向国际或不同国家、区域提供不同内容的门户网站，那您需要尽最大的努力扩大您的国际受众范围，确保网站在全球范围内被注意到。这时，您就需要国际SEO了。</p>
<h2 id="1-什么是国际SEO"><a href="#1-什么是国际SEO" class="headerlink" title="1. 什么是国际SEO ?"></a>1. 什么是国际SEO ?</h2><p>首先，我来普及一下概念，</p>
<ul>
<li>国际SEO， International SEO （国际搜索引擎优化），是优化您的网站的过程，以便搜索引擎可以轻松识别您要定位的国家、地区以及用于业务的语言。</li>
<li>多语言网站，是指使用多种语言提供内容的网站。例如，香港的企业向用户提供繁体中文和英文的网站。</li>
<li>多区域网站，是指以不同国家、区域的用户为目标受众的网站。例如，某厂商，同时会向美国、加拿大、中国等多个国家发货商品。</li>
</ul>
<p>如下图，搜索引擎向不同地理区域的用户展示不同的语言、币种、计量单位的结果。搜索引擎会尝试向搜索用户提供与用户的语言、区域最匹配最恰当的网页版本，那么，我们如何告知用户和搜索引擎哪些才是最匹配的网页呢？</p>
<p><img src="/multi-languages-site-seo/1.jpg" alt="img"></p>
<h2 id="2-国际站点的URL结构"><a href="#2-国际站点的URL结构" class="headerlink" title="2. 国际站点的URL结构"></a>2. 国际站点的URL结构</h2><p>首先，先介绍多语言多区域国际站点一般的URL结构，国际站点一般有4中方式来向用户和搜索引擎指明当前页面所对应的国家、区域和语言。分别是ccTLD、子域名、子目录、具有语言、区域参数的gTLD 。</p>
<ul>
<li><p>ccTLD（国家顶级域 Country code top-level domain）</p>
<p>ccTLD ，根据Google的定义，ccTLD使用双字母代码向用户和搜索引擎指明网站所在的国家、地区。</p>
<p><strong>优点：</strong></p>
<ul>
<li>地理位置定位明确（作用减弱）</li>
<li>在目标用户的搜索结果页面中排名更高</li>
<li>与服务器位置无关</li>
<li>便于区分网站</li>
<li>如果您拥有财务和技术资源，使用ccTLD可能是个好主意。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>您需要付出更多努力才能获得普及新域名，一起得从头开始。</li>
<li>价格昂贵（并且可能存在使用限制，如需要备案、需要在本国存放服务器）</li>
<li>需有更多基础架构</li>
<li>全新网站，搜索引擎不会将页面权重从您的原始域名转移到此域名，网页需要重新索引。</li>
</ul>
<p>提示：Google搜索将不再使用域名来指示国家/地区服务。<a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.blog.google%2Fproducts%2Fsearch%2Fmaking-search-results-more-local-and-relevant%2F">Making search results more local and relevant</a></p>
<p>eg: <code>domain.cn</code></p>
</li>
<li><p>gTLD的子域名（gTLD，通用顶级域 Generic top-level domain）</p>
<p><strong>优点：</strong></p>
<ul>
<li>允许使用不同的服务器位置</li>
<li>便于区分网站</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>全新网站，不能继承主域权重</li>
<li>本地化的优化过程更加复杂</li>
</ul>
<p>eg: <code>cn.domain.com</code></p>
</li>
<li><p>gTLD的子目录 — 国际化内容放置在根域下的特定子目录或文件夹中。</p>
<p><strong>优点：</strong></p>
<ul>
<li>维护成本用低</li>
<li>易于设置</li>
<li>见效快，更容易获得搜索引擎的新人，直接使用原网站权重，很快被索引</li>
<li>这是资源有限的企业的最佳选择。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>提供弱的地理定位信号</li>
<li>没有针对不同子目录的特定IP地址</li>
<li>更难维护不同版本的国家/地区目录</li>
<li>搜索引擎的处罚会影响到所有目录</li>
</ul>
<p>eg: <code>domain.com/cn</code></p>
</li>
</ul>
<p><img src="multi-languages-site-seo/2.jpg" alt="img"></p>
<ul>
<li><p>URL参数 （不推荐）</p>
<p><strong>缺点：</strong></p>
<ul>
<li>参数不可靠，有时它们会被编入索引，有时则不会。搜索引擎更喜欢唯一的URL</li>
</ul>
<p>eg: <code>domain.com/?lang=zh-cn</code></p>
</li>
</ul>
<p>最好的国际站点的URL结构是什么，没有标准答案。只能说，每种方法都有一些优点和缺点，适合自己的就是最好的。</p>
<h2 id="3-如何处理多语言多区域网站中的重复网页"><a href="#3-如何处理多语言多区域网站中的重复网页" class="headerlink" title="3. 如何处理多语言多区域网站中的重复网页"></a>3. 如何处理多语言多区域网站中的重复网页</h2><p>我们为多个国家提供同一种语言的内容，会造成重复页面而受到惩罚吗？答案是否定的。根据区域定位的本地化内容不是垃圾内容，有着正当的商业理由。</p>
<ul>
<li>如果您在同一个多区域网站的不同网址以同一种语言提供类似内容或重复内容（例如，如果 <code>example.de/</code> 和 <code>example.com/de/</code> 都显示类似的德语内容），则应使用 <code>rel=canonical</code>设定一个权威版本。</li>
<li>使用hreflang标签。</li>
<li>本地化关键字优化。</li>
<li>添加本地信息，例如电话，货币，计量单位和地址等。</li>
<li>本地化的HTML站点地图。</li>
<li>本地化导航。</li>
<li>与观众产生共鸣的本地化图像。</li>
<li>专业的翻译、本地化的内容，而不是机器翻译。</li>
<li>从本地ccTLD获取指向您本地化内容的外部链接。</li>
</ul>
<h2 id="4-使用语言标记确定您的网页所针对的语言"><a href="#4-使用语言标记确定您的网页所针对的语言" class="headerlink" title="4. 使用语言标记确定您的网页所针对的语言"></a>4. 使用语言标记确定您的网页所针对的语言</h2><p>国际SEO最大的问题之一就是重复页面，解决此问题的最有效方法是使用 <a href="https://link.juejin.im/?target=https%3A%2F%2Fmoz.com%2Flearn%2Fseo%2Fhreflang-tag">hreflang</a>。这使得搜索引擎能够识别出应向特定用户展示的最匹配的网页版本。</p>
<p>例如，您有一个英文网页面向多个国家，英国的搜索用户将搜索到对应 <code>hreflang=&quot;en-gb&quot;</code> 的网页，而美国的搜索用户将搜索到对应 <code>hreflang=&quot;en-us&quot;</code> 的网页。</p>
<h3 id="（1）使用hreflang帮助搜索引擎识别网页版本"><a href="#（1）使用hreflang帮助搜索引擎识别网页版本" class="headerlink" title="（1）使用hreflang帮助搜索引擎识别网页版本"></a>（1）使用hreflang帮助搜索引擎识别网页版本</h3><p>将 <code>&lt;link rel=&quot;alternate&quot; hreflang=&quot;lang_code&quot;... /&gt;</code> 元素添加到网页标头中，以将网页的所有语言和区域变体告知搜索引擎。如果您没有站点地图或无法为您的网站指定 HTTP 响应标头，此方法非常有用。</p>
<p>您应在 <code>&lt;head&gt;</code> 元素中为网页的每个变体分别添加一组 <code>&lt;link&gt;</code> 元素（由每个网页变体（包括网页自身）的链接组成）。网页的每个版本所对应的那组链接都应是相同的。</p>
<p>以下是每个 <code>link</code> 元素的语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;lang_code&quot; href&#x3D;&quot;url_of_page&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p><code>lang_code</code> 此网页版本所定位的受支持的语言/区域代码，或 <code>x-default</code>（以与该网页上的 <code>hreflang</code> 标记未明确列出的任何语言匹配）。</p>
<p><code>url_of_page</code> 此网页版本的完全限定网址（与指定的语言/区域对应）。 示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Widgets, Inc&lt;&#x2F;title&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;en-gb&quot;</span><br><span class="line">        href&#x3D;&quot;http:&#x2F;&#x2F;en-gb.example.com&#x2F;page.html&quot; &#x2F;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;en-us&quot;</span><br><span class="line">        href&#x3D;&quot;http:&#x2F;&#x2F;en-us.example.com&#x2F;page.html&quot; &#x2F;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;en&quot;</span><br><span class="line">        href&#x3D;&quot;http:&#x2F;&#x2F;en.example.com&#x2F;page.html&quot; &#x2F;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;de&quot;</span><br><span class="line">        href&#x3D;&quot;http:&#x2F;&#x2F;de.example.com&#x2F;page.html&quot; &#x2F;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;alternate&quot; hreflang&#x3D;&quot;x-default&quot;</span><br><span class="line">        href&#x3D;&quot;http:&#x2F;&#x2F;www.example.com&#x2F;&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>



<p><img src="/multi-languages-site-seo/3.jpg" alt="img"></p>
<p>使用hreflang中的常见错误：</p>
<ul>
<li>只有地区，没有语言</li>
<li>地区在前，语言在后</li>
<li>使用了多个x-default</li>
<li>代码错误，如英国地区应该是GB ，而不是UK</li>
</ul>
<h3 id="（2）HTTP-响应标头"><a href="#（2）HTTP-响应标头" class="headerlink" title="（2）HTTP 响应标头"></a>（2）HTTP 响应标头</h3><p>您可以将相应网页所有语言、区域的变体告知搜索引擎，这种方法对不能设置 html 标记的 pdf 很有用。 标头格式如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Link: <span class="tag">&lt;<span class="name">http:</span>//<span class="attr">en-gb.example.com</span>/<span class="attr">page.html</span>&gt;</span>; rel="alternate"; hreflang="en-gb", <span class="tag">&lt;<span class="name">http:</span>//<span class="attr">en-us.example.com</span>/<span class="attr">page.html</span>&gt;</span>; rel="alternate"; hreflang="en-us", ...</span><br></pre></td></tr></table></figure>

<h3 id="（3）XML-sitemap-站点地图"><a href="#（3）XML-sitemap-站点地图" class="headerlink" title="（3）XML sitemap 站点地图"></a>（3）XML sitemap 站点地图</h3><p>您可以使用站点地图将每个网址的所有语言和区域变体告知搜索引擎。为此，请添加一个用于指定单个网址的 <code>&lt;loc&gt;</code> 元素，其中的子 <code>&lt;xhtml:link&gt;</code> 条目应列出相应网页的每种语言/语言区域变体（包括网页自身）。因此，如果您的某个网页有 3 个版本，那么您的站点地图便应包含 3 个条目，每个条目都应包含 3 个完全相同的子条目。</p>
<p>站点地图规则：</p>
<ul>
<li>按如下方式指定 xhtml 命名空间：<code>xmlns:xhtml=&quot;http://www.w3.org/1999/xhtml&quot;</code></li>
<li>为每个网址分别创建一个单独的 <code>&lt;url&gt;</code> 元素。</li>
<li>每个 <code>&lt;url&gt;</code> 元素都必须包含一个指示网页网址的 子元素。</li>
<li>每个 <code>&lt;url&gt;</code> 元素都必须包含一个子元素 <code>&lt;xhtml:link rel=&quot;alternate&quot; hreflang=&quot;supported_language-code&quot;&gt;</code>，其中应列出相应网页的每个备用版本（包括网页自身）。这些子 <code>&lt;xhtml:link&gt;</code>元素的顺序无关紧要。 示例：</li>
<li><code>www.example.com/en</code> ，以英语用户为目标用户。</li>
<li><code>www.example.com/de</code> ，以德语用户为目标用户。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">urlset</span> <span class="attr">xmlns</span>=<span class="string">"http://www.sitemaps.org/schemas/sitemap/0.9"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xhtml</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">loc</span>&gt;</span>http://www.example.com/en<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xhtml:link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"alternate"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hreflang</span>=<span class="string">"de"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"http://www.example.com/de"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xhtml:link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"alternate"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hreflang</span>=<span class="string">"en"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"http://www.example.com/en"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">loc</span>&gt;</span>http://www.example.com/de<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xhtml:link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"alternate"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hreflang</span>=<span class="string">"de"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"http://www.example.com/de"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xhtml:link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"alternate"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hreflang</span>=<span class="string">"en"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"http://www.example.com/en"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">urlset</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>更多 sitemap 的相关知识请参考： <a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.sitemaps.org%2Fprotocol.html">sitemaps.org - Sitemaps XML format</a></p>
<h3 id="（4）语言元标记"><a href="#（4）语言元标记" class="headerlink" title="（4）语言元标记"></a>（4）语言元标记</h3><p>虽然Google和Yandex目前使用hreflang属性，但Bing使用的是<a href="https://link.juejin.im/?target=http%3A%2F%2Fblogs.bing.com%2Fwebmaster%2F2011%2F03%2F01%2Fhow-to-tell-bing-your-websites-country-and-language%2F">语言元标记</a> ： <code>&lt;meta http-equiv=“content-language” content =“en-us” /&gt;</code></p>
<h3 id="（5）注意事项："><a href="#（5）注意事项：" class="headerlink" title="（5）注意事项："></a>（5）注意事项：</h3><ol>
<li><p>hreflang 属性的值用于标识备用网址的语言（以</p>
<p>ISO 639-1</p>
<p>格式表示）和区域（可选，以</p>
<p>ISO 3166-1 alpha-2</p>
<p>格式表示）。例如：</p>
<ul>
<li>de：德语内容，不限区域</li>
<li>en-GB：英语内容，面向英国境内的用户</li>
<li>de-ES：德语内容，面向西班牙境内的用户</li>
</ul>
</li>
<li><p>请考虑为不匹配的语言添加后备网页，尤其是在语言/国家/地区选择器中或是在会自动重定向的主页上。在这种情况下，请使用 x-default 值：<code>&lt;link rel=&quot;alternate&quot; href=&quot;http://example.com/&quot; hreflang=&quot;x-default&quot; /&gt;</code></p>
</li>
<li><p>备用网址必须是完全限定的网址，包含传输协议、域名。</p>
</li>
<li><p>备用网址无需位于同一个网域中。</p>
</li>
<li><p>如果两个网页没有互指，系统将会忽略相关标记。</p>
</li>
<li><p>使用页面标记或XML sitemap，最好不要同时使用两者。</p>
</li>
<li><p>Google开始根据搜索者的位置生成搜索结果，无论搜索者使用的是哪个Google本地版本。</p>
</li>
<li><p>第三方工具推荐：</p>
<ul>
<li>页面标签生成器：<a href="https://link.juejin.im/?target=http%3A%2F%2Fwww.internationalseomap.com%2Fhreflang-tags-generator">www.internationalseomap.com/hreflang-ta…</a></li>
<li>Hreflang验证器：<ul>
<li><a href="https://link.juejin.im/?target=http%3A%2F%2Fflang.dejanseo.com.au%2F">flang.dejanseo.com.au/</a></li>
<li><a href="https://link.juejin.im/?target=http%3A%2F%2Fhreflang.ninja">hreflang.ninja</a> /</li>
<li><a href="https://link.juejin.im/?target=http%3A%2F%2Fwww.screamingfrog.co.uk">www.screamingfrog.co.uk</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.deepcrawl.com%2F">www.deepcrawl.com/</a></li>
</ul>
</li>
<li>XML站点地图生成器：<ul>
<li><a href="https://link.juejin.im/?target=http%3A%2F%2Fwww.themediaflow.com%2Ftool_hreflang">www.themediaflow.com/tool_hrefla…</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.xml-sitemaps.com">www.xml-sitemaps.com</a></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="5-使用-rel-”canonical”-标记"><a href="#5-使用-rel-”canonical”-标记" class="headerlink" title="5. 使用 rel=”canonical” 标记"></a>5. 使用 rel=”canonical” 标记</h2><ol>
<li>使用 rel=”canonical” link 元素标记所有重复的网页。将属性为 rel=”canonical” 的 <code>&lt;link&gt;</code>元素添加到重复网页的 <code>&lt;head&gt;</code> 部分中，并使其指向权威网页，如下所示： <code>&lt;link rel=&quot;canonical&quot; href=&quot;https://example.com/cn/&quot; /&gt;</code></li>
<li>如果权威网页有对应的移动版变体，请为其添加 rel=”alternate” 链接，并使其指向此网页的移动版： <code>&lt;link rel=&quot;alternate&quot; media=&quot;only screen and (max-width: 640px)&quot; href=&quot;http://m.example.com/cn/”&gt;</code></li>
<li>为此网页添加适当的 hreflang 或其他重定向。</li>
</ol>
<h2 id="6-需要专业的翻译、本土化的内容"><a href="#6-需要专业的翻译、本土化的内容" class="headerlink" title="6. 需要专业的翻译、本土化的内容"></a>6. 需要专业的翻译、本土化的内容</h2><p>因为非常多时候由于搜索词的文化差异，一些语言的热门关键词在另一种语言的搜索引擎中是没有排名的。所以如果从你自己本身的语言文化出发，你可能会错过很多将人们吸引到你网站上的神奇关键词。</p>
<p>例如， 颜色，在英国是 colour ，而美式英语则是 color 。</p>
<p>服务器，在香港叫伺服器；程序叫程式。</p>
<p>如果你将“市场研究”从中文翻译成英文，最直接的翻译是“market study”。但是翻译成“case study“、 “market research” 您会得到更好的效果。</p>
<p>使用这些更亲近本土搜素引擎的关键词不仅意味着你的内容将更具流动性，同时也意味着你的内容比那些使用机器直译关键词的内容更容易被搜索到，概率提高了50多倍。</p>
<p><img src="/multi-languages-site-seo/4.jpg" alt="img"></p>
<p>market research, case study, market study - Google 趋势</p>
<h2 id="7-外链"><a href="#7-外链" class="headerlink" title="7. 外链"></a>7. 外链</h2><p>我们有必要在与本网站相关的同语言网站、本地ccTLD网站中投放一些导向自身网站的外部链接。这是因为相较于不同语言的链接，搜索引擎会给予同一种语言的链接更高的权重。</p>
<h2 id="8-适合当地市场的设计"><a href="#8-适合当地市场的设计" class="headerlink" title="8. 适合当地市场的设计"></a>8. 适合当地市场的设计</h2><p>设计、用户体验、网站架构 — 所有这些在SEO中扮演着越来越重要的角色。通过本地化设计，您可以减少重复内容。</p>
<p>不同国家的文化差异不仅影响你网站的内容或关键字，甚至可能影响整个网站。</p>
<p>不同国家，越来越多的人都在使用移动设备来浏览网站，特别是在美国、日本、韩国这些高度移动化的国家，你有必要为网站做一个响应式设计。</p>
<p>不同文化的人们对于颜色的认识尽管有相似点，但他们对各种颜色的感觉会不同，甚至截然相反，其原因是由于国家所处的地理位置、历史文化背景和风俗习惯不同。例如：绿色在中国象征着新生与希望，而西方文化的人们会将绿色与“缺乏经验”联系起来；在中国象征着高贵与权力的黄色，在巴西被视为绝望的象征；因此在为海外市场挑选官方用色时，你最好考虑当地人对颜色的感受。</p>
<h2 id="9-国际SEO中的常见误区"><a href="#9-国际SEO中的常见误区" class="headerlink" title="9. 国际SEO中的常见误区"></a>9. 国际SEO中的常见误区</h2><ul>
<li><p>使用 cookie 存储区域、语言</p>
<p>一些网站将语言、区域信息存在在cookie ，根据cookie来向用户展示对应的页面版本。而搜索引擎在抓取页面时并不支持cookie ，除了默认版本外，它什么都看不到。同时，也创建了一个不太好的用户体验。例如，我访问到一个中文页面，通过email向朋友转发。朋友打开的时候，因为他的浏览器中没有设置中文的cookie ，页面被重定向到了一个默认的英文页面，他看到的并非我预期的结果。甚至，他若不认识英文，那他永远无法找到这个中文版本的页面。</p>
</li>
<li><p>Javascript 切换语言</p>
<p>一些网站通过 Javascript 来加载本地化内容，但不会更改不同语言、区域的URL，而且没有不同的URL来匹配所访问内容。这种情况下，由于搜索引擎无法执行Javascript, 它除了访问默认的版本外，永远无法访问其他区域语言的内容。同时，用户也无法通过URL定位到本地化版本页面。</p>
</li>
<li><p>根据IP、Accept-Language 自动重定向</p>
<p>这样做往往不单影响收录，也影响用户体验。原因有以下几点：</p>
<ol>
<li>大部分搜索引擎只从少数IP地址进行抓取。</li>
<li>我们设置的IP库通常不全。</li>
<li>重定向对页面加载时间产生负面影响。</li>
<li>如果您使用外语网站，Chrome一般会问你不要翻译，如果您选择了不需要重复，Chrome 会把该语言放入请求头Acept-Language当中。</li>
<li>搜索引擎一般不会带上Acept-Language。 事实上，Google已经改进并将继续改进其区域设置感知抓取能力。<a href="https://link.juejin.im/?target=https%3A%2F%2Fwebmasters.googleblog.com%2F2015%2F01%2Fcrawling-and-indexing-of-locale.html">截至2015年初</a>，他们宣布Googlebot将从世界各地的许多IP地址（而不仅仅是美国）进行抓取，并将使用Accept-Lang请求头查看您的网站是否根据用户区域语言信息设置并更改页面内容。但同时，他们非常清楚这项技术并不完美，这并不能取代使用hreflang的建议。</li>
</ol>
<p>相反，更好的用户体验是当您检测到用户可能会发现您的网站的另一部分更相关时，该横幅就会出现。</p>
<p><img src="/multi-languages-site-seo/5.jpg" alt="img"></p>
<p>来源于apple.com</p>
</li>
</ul>
<p>  永不使用自动重定向规则的一个例外是，当用户选择您网站上的国家、地区或语言首选项时，您应该将该首选项存储在Cookie中，并在用户访问时将其重定向到其首选语言环境的版本页面上。同时要确保他们可以随时设置新的首选项，更新cookie。</p>
<ul>
<li><p>添加hreflang标签将有助于我的跨国内容排名更好</p>
<p>Hreflang标签是国际SEO工具中最强大的工具之一。他们是成功的国际SEO策略的基础。但是，它们并不是一个排名因素。相反，它们旨在确保在Google搜索结果中显示正确的本地化页面。</p>
</li>
<li><p>使用旗帜图标来表示网站的语言</p>
<p>旗帜不是语言，例如英国旗帜并不代表英语。对于说这种语言但不是来自该国家的任何用户来说，代表语言使用者的国家旗帜是非常令人反感的。</p>
<p><img src="/multi-languages-site-seo/6.jpg" alt="img"></p>
</li>
</ul>
<p>  Flags symbolize nations, not languages</p>
<ul>
<li><p>需要本地服务器来托管网站内容</p>
<p>因为Google和Bing过去曾明确表示，本地服务器在是一个重要的国际排名因素。事实上Google 及其他搜索引擎表示，现在本地服务器并不像以前那么重要。随着CDN的普及，通常不需要本地服务器。而您只需考虑的是，目标区域用户获取您的网页速度的体验优化。</p>
</li>
<li><p>国际搜索引擎 == Google ?</p>
<p>虽然谷歌是迄今为止全球搜索引擎中最常用的，但在一些国家，有一些本地的搜索引擎比谷歌更受欢迎。如果您的目标受众区域中包含这些地区，那您仍需要对其做好针对性的SEO 。 如：</p>
<ul>
<li>中国（大陆地区）Baidu <code>www.baidu.com</code></li>
<li>俄罗斯和东欧国家 Yandex <code>www.yandex.com</code></li>
<li>韩国 NAVER <code>www.naver.com</code></li>
</ul>
</li>
</ul>
<p>  <img src="/multi-languages-site-seo/7.jpg" alt="img"></p>
<h2 id="10-后话"><a href="#10-后话" class="headerlink" title="10. 后话"></a>10. 后话</h2><p>相信现在，您已经对国际SEO有了一定的了解。随着搜索引擎的不断发展，文中的一些观点也必定会过时，未来的您也应该带着审视的眼观来阅读、理解此文。Let’s do it .</p>
<p>参考文章：</p>
<ul>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fwebmasters.googleblog.com%2Fsearch%2Flabel%2Flocalization">Google Webmaster Central Blog</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fsupport.google.com%2Fwebmasters%2Ftopic%2F2370587">Google Search Console帮助</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fmoz.com%2Flearn%2Fseo%2Finternational">Learn About International SEO</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fmoz.com%2Fblog%2Fthe-international-seo-checklist">The International SEO Checklist</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/12/multi-languages-site-seo/" data-id="cka5femkv003hgbu4gb0ze3j6" class="article-share-link" data-share="baidu" data-title="多语言多区域网站SEO的快速入门">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SEO/" rel="tag">SEO</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-git-head-detached-solution" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/11/git-head-detached-solution/" class="article-date">
  <time datetime="2018-12-11T06:00:42.000Z" itemprop="datePublished">2018-12-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/11/git-head-detached-solution/">Git HEAD detached from XXX (git HEAD 游离)解决</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是-HEAD"><a href="#什么是-HEAD" class="headerlink" title="什么是 HEAD"></a>什么是 HEAD</h3><p>Git 中的 HEAD 可以理解为一个指针，我们可以在命令行中输入 cat .git/HEAD 查看当前 HEAD 指向哪儿，一般它指向当前工作目录所在分支的最新提交。</p>
<p><img src="1.jpeg" alt="tested"></p>
<p>当使用 git checkout &lt; branch_name&gt; 切换分支时，HEAD 会移动到指定分支。</p>
<p><img src="2.jpeg" alt="git-detached"></p>
<p>但是如果使用的是 git checkout &lt; commit id&gt;，即切换到指定的某一次提交，HEAD 就会处于 detached 状态（游离状态）。</p>
<p><img src="/git-head-detached-solution/3.jpeg" alt="git-detached"></p>
<h3 id="HEAD-游离状态的利与弊"><a href="#HEAD-游离状态的利与弊" class="headerlink" title="HEAD 游离状态的利与弊"></a>HEAD 游离状态的利与弊</h3><p>HEAD 处于游离状态时，我们可以很方便地在历史版本之间互相切换，比如需要回到某次提交，直接 checkout 对应的 commit id 或者 tag 名即可。</p>
<p>它的弊端就是：在这个基础上的提交会新开一个匿名分支！</p>
<p><img src="/git-head-detached-solution/4.jpeg" alt="git-detached"></p>
<p>也就是说我们的提交是无法可见保存的，一旦切到别的分支，游离状态以后的提交就不可追溯了。</p>
<p><img src="/git-head-detached-solution/5.jpeg" alt="git-detached"></p>
<p>解决办法就是新建一个分支保存游离状态后的提交：</p>
<p><img src="/git-head-detached-solution/6.jpeg" alt="git-detached"></p>
<h3 id="具体解决操作"><a href="#具体解决操作" class="headerlink" title="具体解决操作"></a>具体解决操作</h3><ol>
<li><p>git branch -v 查看当前领先多少，确定游离前的分支，新建一个 temp 分支，把当前提交的代码放到整个分支 </p>
</li>
<li><p>checkout 出要回到游离前的分支 </p>
</li>
<li><p>然后 merge 刚才创建的临时分支，把那些代码拿回来 </p>
</li>
<li><p>git status 查看下合并结果，有冲突就解决 </p>
</li>
<li><p>合并 OK 后就提交到远端 </p>
</li>
<li><p>删除刚才创建的临时分支</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/11/git-head-detached-solution/" data-id="cka5femkm002jgbu417zt6ve8" class="article-share-link" data-share="baidu" data-title="Git HEAD detached from XXX (git HEAD 游离)解决">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/" rel="tag">Git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-youzan-personal-payment" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/07/youzan-personal-payment/" class="article-date">
  <time datetime="2018-12-07T10:16:18.000Z" itemprop="datePublished">2018-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/07/youzan-personal-payment/">通过有赞云实现个人在线支即时到账</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>很多人都想出售自己的一些产品，课程，电子书，或者其它在线可售卖的东西，但是不管是微信支付还是支付宝，都需要公司账户，这一套不是不可以搞，就是太麻烦了而已。今天介绍的就是不需要公司账号实现个人收款的自动化方案（当然，交易 1% 手续费比微信等略高）。</p>
<p>思路是：</p>
<p><strong>环境准备</strong>：在有赞开通微小店（免费）-&gt; 注册有赞云 -&gt; 创建自用型应用 -&gt; 绑定微小店 -&gt; 开通 push (推送交易状态)</p>
<p><strong>交易流程</strong>：调用有赞云的收银 API ，创建支付二维码(并存储二维码 id 到自有网站订单) -&gt; 用户扫描二维码并支付 -&gt; 推送交易状态到你的网站 -&gt; 更新网站订单状态 -&gt; 完成购买</p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a><strong>环境准备</strong></h2><p><strong>第一步：开通微小店</strong></p>
<p>去这里注册并开通小店：<a href="http://link.zhihu.com/?target=https%3A//h5.youzan.com/v2/index/wxdpc">有赞微小店_微店怎么开_微店网页登录/下载 - 做生意，用有赞</a></p>
<p><strong>第二步：注册有赞云</strong></p>
<p>去这里注册个人开发者：<a href="http://link.zhihu.com/?target=https%3A//www.youzanyun.com/">有赞云 - 做软件，用有赞云</a>，然后创建<strong>自用型</strong>应用，默认微商城，填写应用名称点下一步，授权店铺，选择你上面开通的小店名称并完成授权绑定。</p>
<p><strong>第三步：开通应用动态推送</strong></p>
<p>这一步主要是接收订单交易状态的，用户发起支付与支付完成都有推送消息，后面我们会介绍如何处理推送。</p>
<p>开通推送的方法：有赞云控制台 -&gt; 应用设置 -&gt; 开发信息 -&gt; 修改 -&gt; 填写接收推送的网址即可。</p>
<p>环境已经准备 OK 了，你的手机上应该已经装了微小店应用了，接下来我们要发起交易，开始之前我们得准备好 SDK，如果你使用 Laravel，我封了一个包：<a href="http://link.zhihu.com/?target=https%3A//github.com/overtrue/laravel-youzan">overtrue/laravel-youzan</a>，如果你是其它框架，那么请使用 HanSon 的封装：<a href="http://link.zhihu.com/?target=https%3A//github.com/HanSon/youzan-sdk">HanSon/youzan-sdk</a>。当然还有一个选择，官方 SDK：<a href="http://link.zhihu.com/?target=https%3A//github.com/youzan/open-sdk-php">youzan/open-sdk-php</a>。</p>
<p>安装完 SDK，配置环境我们需要一些参数：</p>
<ul>
<li>client_id: 应用ID，在有赞云控制台 -&gt; 应用设置 页可以找到</li>
<li>client_secret 密钥，同样在应用设置页</li>
<li>kdt_id 其实就是原来的口袋通ID，就是应用设置页基本信息中的 “授权店铺id”</li>
</ul>
<h2 id="交易流程"><a href="#交易流程" class="headerlink" title="交易流程"></a><strong>交易流程</strong></h2><p><strong>第一步：创建收款二维码</strong></p>
<p>这一步一般是用户在你的网站选择完商品，或者在购物车点结算，你在自己网站创建完订单后，调用有赞云收银 API 创建二维码，以我的包为例（大同小异啦）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$result = \Youzan::request(<span class="string">'youzan.pay.qrcode.create'</span>, [</span><br><span class="line">                <span class="string">'qr_type'</span> =&gt; <span class="string">'QR_TYPE_DYNAMIC'</span>,  <span class="comment">// 这个就不要动了</span></span><br><span class="line">                <span class="string">'qr_price'</span> =&gt; <span class="number">100</span>,  <span class="comment">// 金额：分</span></span><br><span class="line">                <span class="string">'qr_name'</span> =&gt; <span class="string">'iPhone 8 plus 64G 金色'</span>, <span class="comment">// 收款理由</span></span><br><span class="line">                <span class="string">'qr_source'</span> =&gt; <span class="string">'102828399222'</span>, <span class="comment">// 自定义字段，你可以设置为网站订单号</span></span><br><span class="line">            ])<span class="string">'</span></span><br></pre></td></tr></table></figure>



<p>得到的结果呢包含三个值：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"qr_id": "19707",</span><br><span class="line">"qr_url": "https://trade.koudaitong.com/wxpay/confirmQr?qr_id=19707&amp;kdt_id=55",</span><br><span class="line">"qr_code": "data:image/png;base64,iV......"</span><br></pre></td></tr></table></figure>

<p>其中 qr_id 你需要与刚才的订单绑定（这里取决于你自己的实现了，比如你在网站应该有 payments 表用于专门记录支付记录）</p>
<p>qr_url 呢其实就是扫码完打开的页面，qr_code 是图片内容，可以直接放到 img 的 src 中，data-url 格式。就是一个二维码图片。</p>
<p>用户扫码后打开一个网址完成付款。这时候你的手机 app 微小店会告诉你有新的订单。</p>
<p>接下来就是处理交易结果了。</p>
<p><strong>第二步：主动查询订单</strong></p>
<p>为啥要主动查询呢，不是有推送么，对，但是推送的时间以及成功率是无法保证的，所以我们应该主动去查询，我的做法是在交易创建完成后，定时（2秒左右）查询一次订单信息：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$payment = Payment::whereQrId(<span class="string">'19707'</span>);</span><br><span class="line">$result = Youzan::request(<span class="string">'youzan.trades.qr.get'</span>, [</span><br><span class="line">     <span class="string">'qr_id'</span> =&gt; $payment-&gt;qr_id, </span><br><span class="line">     <span class="string">'status'</span> =&gt; <span class="string">'TRADE_RECEIVED'</span></span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($result[<span class="string">'total_results'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    $order = array_pop($result[<span class="string">'qr_trades'</span>]);</span><br><span class="line">    $payment-&gt;status = Payment::STATUS_SUCCEED;</span><br><span class="line">    $payment-&gt;save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面我们先从自己的数据库根据 qr_id 查询交易记录得到 $payment，然后调用了有赞云 API 的二维码订单列表得到这个二维码产生的成功的交易订单。</p>
<p>如果得到成功交易的订单数量大于 0 （一般就一笔），就更新支付状态为成功。</p>
<p>反之，继续查，这里一般有一个限制，比如查10次没有交易就关闭，或者其它你觉得 OK 的策略都可以。</p>
<p><strong>第三步：处理推送</strong></p>
<p>这一步与其它支付的情况不太一样，因为推送过来的内容不是直接就能与你的订单关联上的，推送过来的内容中有一个 id 字段，这是有赞的订单 ID ，不是我们的订单 ID，我们先要拿这个 ID 去他们的 API 取到交易详情，然后再从交易详情得到 qr_id 才能查出我们订单的关联信息。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($request-&gt;get(<span class="string">'type'</span>) == <span class="string">'TRADE_ORDER_STATE'</span> </span><br><span class="line">    &amp;&amp; $request-&gt;get(<span class="string">'status'</span>) == <span class="string">'TRADE_SUCCESS'</span>) &#123;</span><br><span class="line">    $order = Youzan::request(<span class="string">'youzan.trade.get'</span>, [<span class="string">'tid'</span> =&gt; $request-&gt;id]);</span><br><span class="line"></span><br><span class="line">    $payment = Payment::WhereQrId($order[<span class="string">'trade'</span>][<span class="string">'qr_id'</span>])-&gt;first();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($payment &amp;&amp; $payment-&gt;status !== <span class="keyword">self</span>::STATUS_SUCCEED) &#123;</span><br><span class="line">        $payment-&gt;status = Payment::STATUS_SUCCEED;</span><br><span class="line">        $payment-&gt;save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>获取交易详情 API 为 youzan.trade.get，传入的 tid 就是推送内容里的 id。二维码 ID 在交易详情的 trade 里。</p>
<p>那这一套流程就实现完了，个人感觉还是非常容易的，收款完成你就可以在微小店提现了。</p>
<p>个人觉得这一套下来接入成本非常的低，然后还有一个非常大的好处是给你省去很多开发工作，因为在手机 app 上随时有推送，以及订单管理，每天的收益统计等，很方便，当然 1% 的手续费感觉其实还好吧，毕竟你的个人站交易也大不到百万千万这样的额度去。</p>
<p>相关资料：</p>
<p>有赞云：<a href="http://link.zhihu.com/?target=http%3A//www.youzanyun.com/">www.youzanyun.com</a></p>
<p>微小店：<a href="http://link.zhihu.com/?target=https%3A//h5.youzan.com/v2/index/wxdpc">有赞微小店_微店怎么开_微店网页登录/下载 - 做生意，用有赞</a></p>
<p>收银台 API: <a href="http://link.zhihu.com/?target=https%3A//www.youzanyun.com/apilist/list/group_trade/pay_qrcode">收银台API - 有赞云</a></p>
<p>交易 API: <a href="http://link.zhihu.com/?target=https%3A//www.youzanyun.com/apilist/list/group_trade/trade">商家管理订单API - 有赞云</a></p>
<p>overtrue/laravel-youzan: <a href="http://link.zhihu.com/?target=https%3A//github.com/overtrue/laravel-youzan">overtrue/laravel-youzan</a></p>
<p>HanSon/youzan-sdk: <a href="http://link.zhihu.com/?target=https%3A//github.com/HanSon/youzan-sdk">HanSon/youzan-sdk</a></p>
<p>官方 SDK：<a href="http://link.zhihu.com/?target=https%3A//github.com/youzan/open-sdk-php">youzan/open-sdk-php</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/07/youzan-personal-payment/" data-id="cka5femm0007bgbu41wy5gv1m" class="article-share-link" data-share="baidu" data-title="通过有赞云实现个人在线支即时到账">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-mobile-location" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/07/mobile-location/" class="article-date">
  <time datetime="2018-12-07T10:13:36.000Z" itemprop="datePublished">2018-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/07/mobile-location/">获取手机号码归属地及运营商信息</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 手机号码归属地查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $tel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLocation</span><span class="params">($tel)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 过滤参数</span></span><br><span class="line">    <span class="keyword">if</span> ( !isPhoneNumber($tel) ) <span class="keyword">return</span> [<span class="string">'code'</span>=&gt;<span class="number">200</span>,<span class="string">'status'</span>=&gt;<span class="keyword">false</span>,<span class="string">'msg'</span>=&gt;<span class="string">'Cell phone number error!'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 请求地址</span></span><br><span class="line">    $url = <span class="string">'http://mobsec-dianhua.baidu.com/dianhua_api/open/location?tel='</span>.$tel;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发起请求</span></span><br><span class="line">    <span class="comment">//$res = file_get_contents($url);</span></span><br><span class="line">    $res = curlRequest($url,<span class="string">''</span>,<span class="string">'GET'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( $res[<span class="string">'code'</span>] !== <span class="number">200</span> ) <span class="keyword">return</span> [<span class="string">'code'</span>=&gt;$res[<span class="string">'code'</span>],<span class="string">'status'</span>=&gt;<span class="keyword">false</span>,<span class="string">'msg'</span>=&gt;$res[<span class="string">'responseHeader'</span>][<span class="string">'msg'</span>]];<span class="comment">// 判断请求是否成功</span></span><br><span class="line"></span><br><span class="line">    $data = $res[<span class="string">'response'</span>][$tel];<span class="comment">// 接收返回值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( !$data ) <span class="keyword">return</span> [<span class="string">'code'</span>=&gt;<span class="number">200</span>,<span class="string">'status'</span>=&gt;<span class="keyword">false</span>,<span class="string">'msg'</span>=&gt;<span class="string">'API Exception!'</span>];<span class="comment">// 返回值为空</span></span><br><span class="line"></span><br><span class="line">    $response[<span class="string">'province'</span>] = $data[<span class="string">'detail'</span>][<span class="string">'province'</span>];        <span class="comment">// 归属地</span></span><br><span class="line">    $response[<span class="string">'city'</span>] = $data[<span class="string">'detail'</span>][<span class="string">'area'</span>][<span class="number">0</span>][<span class="string">'city'</span>];   <span class="comment">// 城市</span></span><br><span class="line">    $response[<span class="string">'service'</span>] = $data[<span class="string">'detail'</span>][<span class="string">'operator'</span>];     <span class="comment">// 运行商</span></span><br><span class="line">    $response[<span class="string">'fullname'</span>] = $data[<span class="string">'location'</span>];            <span class="comment">// 运行商全称</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'code'</span>=&gt;<span class="number">200</span>,<span class="string">'status'</span>=&gt;<span class="keyword">true</span>,<span class="string">'data'</span>=&gt;$response];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 手机号码格式验证</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $tel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> bool</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPhoneNumber</span><span class="params">($tel)</span>//手机号码正则表达试</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (preg_match(<span class="string">"/0?(13|14|15|17|18|19)[0-9]&#123;9&#125;/"</span>,$tel))?<span class="keyword">true</span>:<span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发起CURL请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $url 请求地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $data 请求数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $method 请求方式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array 一维数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curlRequest</span><span class="params">($url,$data = <span class="string">''</span>,$method = <span class="string">'POST'</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $ch = curl_init(); <span class="comment">//初始化CURL句柄</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url); <span class="comment">//设置请求的URL</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER,<span class="number">1</span>); <span class="comment">//设为TRUE把curl_exec()结果转化为字串，而s不是直接输出</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $method); <span class="comment">//设置请求方式</span></span><br><span class="line"></span><br><span class="line">    curl_setopt($ch,CURLOPT_HTTPHEADER,<span class="keyword">array</span>(<span class="string">"X-HTTP-Method-Override: $method"</span>));<span class="comment">//设置HTTP头信息</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);<span class="comment">//设置提交的字符串</span></span><br><span class="line">    $document = curl_exec($ch);<span class="comment">//执行预定义的CURL</span></span><br><span class="line">    $code = curl_getinfo($ch,CURLINFO_HTTP_CODE); <span class="comment">//获取HTTP请求状态码～</span></span><br><span class="line">    curl_close($ch);</span><br><span class="line"></span><br><span class="line">    $document = json_decode(removeBOM($document),<span class="keyword">true</span>);</span><br><span class="line">    $document[<span class="string">'code'</span>] = $code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $document;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检测并移除 BOM 头</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $str 字符串</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> string 去除BOM以后的字符串</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeBOM</span><span class="params">($str = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (substr($str, <span class="number">0</span>,<span class="number">3</span>) == pack(<span class="string">"CCC"</span>,<span class="number">0xef</span>,<span class="number">0xbb</span>,<span class="number">0xbf</span>)) &#123;</span><br><span class="line">        $str = substr($str, <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">var_dump( getLocation(<span class="string">'18888888888'</span>) );<span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/07/mobile-location/" data-id="cka5femku003bgbu45np087vl" class="article-share-link" data-share="baidu" data-title="获取手机号码归属地及运营商信息">分享到</a>
      

      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-behavioral-finance-basic" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/03/behavioral-finance-basic/" class="article-date">
  <time datetime="2018-12-03T13:14:07.000Z" itemprop="datePublished">2018-12-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/03/behavioral-finance-basic/">行为金融学的第一课</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这周得到App上线了一门新课，上海财经大学讲席教授陆蓉老师的《行为金融学》。<br>这门课程的含金量非常地高， 它教的是真刀实枪在市场上搏杀的学问。比如，大盘到底可不可以预测？股评家的话为什么不能信？跌久必涨、追涨杀跌，哪种策略才是对的？听完了这门课，相信你会得出全新的答案。</p>
<p>2011年11月，哈佛大学爆出了一件新闻，70名哈佛大学学生集体退选了经济学教授曼昆的《经济学原理》这门课。<br>曼昆是谁啊？经济学大牛，他写的《经济学原理》和《宏观经济学》这两本书是全世界大多数高校经济学的专用教材。<br>但是，这么厉害的一个人，学生们竟然质疑他说，“曼昆，你告诉我们，世界有多理性，市场多么有效，那为什么会发生这么严重的金融危机？你为什么不告诉我们世界运行还有其他规律？”</p>
<p>学生罢选曼昆的课，倒不是说曼昆教得有什么问题，而是借此对教育制度发难，认为学校不该只传授一种知识。<br>这件事在整个教育界引起了反思，在高校里，只开设传统经济学、传统金融学的课程可能是有问题的，应该告诉学生世界是多元化的，认识世界的方式也应该是多元的。</p>
<p>更重要的是，给学生机会，让他们去自己去思考、辨别究竟应该用哪种理论去指导自己的实践。<br>这件事的后续发展是，今天，我们可以看到包括哈佛在内的很多高校开设了《行为金融学》课程，而它也开始颠覆了人们对金融市场的传统认知。</p>
<h3 id="行为金融学是怎么认识世界的？"><a href="#行为金融学是怎么认识世界的？" class="headerlink" title="行为金融学是怎么认识世界的？"></a>行为金融学是怎么认识世界的？</h3><p>我给你讲一个芝加哥大学流传的笑话。</p>
<blockquote>
<p>有人惊呼，地上有一百块钱。传统金融学家说，这不可能，地上不应该有一百元钱的，有的话早被捡走了；而行为金融学家说，怎么不可能啊，他跑去一看，果然有，开开心心地捡走了100块。</p>
</blockquote>
<p>​    你看，<strong>传统金融学研究的是，市场“应该是”什么样，均衡来看，地上不应该有一百元，这是长期的趋势和规律。而行为金融学研究的是，真实市场“实际是”什么样</strong>。</p>
<p>​    行为金融学认为，不能用“应该是”的理论去指导实际决策，这会出问题。就像监管者面对市场时，不能认为市场从长期来看总是对的，就不管它了，要是早点干预市场，说不定金融危机都不会发生。</p>
<p>你仔细想想，其实任何学科和领域都可以用这两种方式来思考问题。</p>
<p>比如，物理学从“应该是”角度来看待宇宙的运行规律，在物理学看来，一切都是均衡的呈现。而在生物学看来，每一个物种“实际是”在优胜劣汰的进化过程中，捕捉自己的生存机会，以完成自我的迭代升级。</p>
<p>再比如说，在司法领域，法学家从“应该是”的角度，保证整个司法体系维持着长远的公平；而律师搜集证据，从“实际是”的角度，为自己的委托人争取权益。</p>
<p>那么同时拥有这两种视角对你有什么用呢？你看待任何领域的事物，“应该是”的视角让你把握长远基准；“实际是”的视角帮助你理解当下正在发生的事。</p>
<p>好，你已经理解了传统金融学和行为金融学的不同视角了，现在我再告诉你这两种视角从哪里来，又会到哪里去。</p>
<h3 id="传统金融学和行为金融学的根本分歧"><a href="#传统金融学和行为金融学的根本分歧" class="headerlink" title="传统金融学和行为金融学的根本分歧"></a>传统金融学和行为金融学的根本分歧</h3><p>如果我们把传统金融学比喻成一棵大树，树有根、有干、有枝、有叶，越是根上的理论，越基础。任何学术进步，都是在这棵树上的某个部位又生了新芽、发了新叶。如果根上的理论不成立，那么整棵树就要坍塌了。</p>
<p>那么，行为金融学是在树的什么位置与传统金融学分开了呢？</p>
<p>答案是：根。行为金融学与传统金融学是从根上分开来的。</p>
<p>它们的理论基础不同，有各自的理论体系，长成了两棵完整的大树。</p>
<p>然而，树冠部分却是重合的，也就是说，传统金融学研究哪些问题，行为金融学同样研究这些问题。只不过，两者的出发点不同，结论就大相径庭。</p>
<p>那么，两棵树的根有何不同？我先举个例子让你理解传统金融学植根于哪里。</p>
<p>经常有人问我，陆老师，我们家孩子以后想从事金融行业的工作，应该学什么专业呢？我告诉你，这个问题的答案其实很简单，而且有个“标准”答案。</p>
<p>金融学，从学科分类来说，是二级学科，它的一级学科是经济学，准确地说，叫应用经济学。你知不知道应用经济学的学科基础是什么？是数学。所以，答案很简单，本科学基础学科数学，硕士转一级学科应用经济学，博士转二级学科金融学。这就是金融学标准的培养路径。</p>
<p>传统金融学认为，金融学是经济学基本理论在金融市场的展现而已。而经济学的最基本假设，或者说树的根是——人是理性的。</p>
<p>简而言之，就是所有人的决策都是可以用数学计算出来，就像机器人一样精确。理性人你也可以理解为机器人。机器人不会出错。因此，均衡的市场条件下，任何时刻观察到的金融资产价格都是那个时刻所有信息的准确反映。<br>这就是“有效市场假说”，它是传统金融学根上的理论，提出这一理论的经济学家尤金·法玛(Eugene Fama)2013年获得了诺贝尔经济学奖。</p>
<p>接下来我们对比看看，行为金融学的根在哪儿。</p>
<p>在20世纪70年代，有两位学者，一位是金融学家，一位是心理学家，他们常在一起聊天，金融学家说，我们研究金融市场的……问题，结论是这样的……，心理学家就说，这好像不对吧？因为从心理学的角度看，结果不会是这样的。</p>
<p>心理学家说得确实没错儿，金融学从根本上说，属于社会科学，社会科学研究的是与“人”相关的社会运行的规律。金融市场买什么、卖什么的决策都是人做出的。那么金融学当然应该先从人出发来研究问题，而不是从数学出发来研究问题，而人是怎么想的、怎么做的，这是心理学的研究领域。</p>
<p>因此，这两个学者开始系统地从心理学出发来研究金融学，开创了行为金融学科，这两位学者就是丹尼尔·卡尼曼(Daniel Kahneman)和阿莫斯·特沃斯基(Amos Tversky)。</p>
<p>2002年，卡尼曼获得了诺贝尔经济学奖，这标志着这个学科正式被学术界所认可。可惜的是，特沃斯基英年早逝，错过了这份荣耀。</p>
<h3 id="行为金融学的特点"><a href="#行为金融学的特点" class="headerlink" title="行为金融学的特点"></a>行为金融学的特点</h3><p>我们从字面意思上来看，“行为金融学”由“行为”二字加“金融学”构成，“行为”取自心理学中的行为主义，它是行为金融学的理论基础。</p>
<p>自卡尼曼和特沃斯基创立了行为金融学派之后，越来越多的人意识到这个学科更能解释金融市场的各种现象。从20世纪80年代开始，这个学派的理论迅速成长，逐渐形成了与传统金融学对峙的态势。</p>
<p>到了20世纪末，甚至有学者说：“我预测，行为金融学在不远的将来将成为一个多余的术语，因为除了这个，还能有什么别的金融学呢？”说这句话的人也是一个行为金融学家，叫理查德·塞勒(Richard Thaler)，他是2017年诺贝尔经济学奖得主。</p>
<p>当然了，后来的事实是，行为金融学也没有完全取代传统金融学，两个理论都在发展。但是，相比于传统金融学，行为金融学更加实战。有意思的是，理查德·塞勒常常被称为“临床经济学家”。什么意思呢？就是能解决现实问题的经济学家。<br>行为金融学最擅长的是投资实战，制定交易策略，我们现在常常见到的所谓“量化交易策略”绝大多数都是以行为金融学理论为基础的。</p>
<p>你在金融市场上看到的一些原来是大学里的金融学教授，后来转做投资实务的，一般都是行为金融学家，而传统金融学家做研究的多、做实务的少。所以，请珍惜给你讲《行为金融学》课的人，因为我们中的很多人讲着讲着就转去做投资实务了。道理很简单，因为收益高嘛。</p>
<p>而且基于行为金融学的交易策略甚至不需要组建一个庞大的团队，也不需要雇佣很多的分析师，去一家家公司做调研。很多成功的行为金融交易团队甚至只有几个人。<br>听上去是不是很神奇？听完我的课，你也一样能做到。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>传统金融学从“应该是”的视角寻找长期均衡的规律；而行为金融学用“实际是”的视角解决当前具体的金融决策。</p>
<p>传统金融学认为市场是不可预测、无法战胜的；而行为金融学认为市场是有规律的，战胜市场是可能的。</p>
<p>原因是，行为金融学是心理学和金融学的交叉学科，而心理学认为人的行为有规律、可以预测。</p>
<p>我还希望你记住的是，我今天讲的学科树的故事。这样，你的学习就可以逐步形成系统化的知识，而不仅仅是收获碎片化的信息。</p>
<h3 id="课后思考"><a href="#课后思考" class="headerlink" title="课后思考"></a>课后思考</h3><p>这一讲的最后，我想给你留一个思考题：如果你要买股票，好公司的股票是不是就是好股票？</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/03/behavioral-finance-basic/" data-id="cka5femjy000hgbu4cjs5av5r" class="article-share-link" data-share="baidu" data-title="行为金融学的第一课">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-gulp-vs-webpack" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/03/gulp-vs-webpack/" class="article-date">
  <time datetime="2018-12-03T03:14:13.000Z" itemprop="datePublished">2018-12-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/03/gulp-vs-webpack/">前端构建工具之争——Webpack vs Gulp 谁会被拍死在沙滩上</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="理想的前端开发流程"><a href="#理想的前端开发流程" class="headerlink" title="理想的前端开发流程"></a>理想的前端开发流程</h1><p>在说构建工具之前得先说说咱期望的前端开发流程是怎样的？</p>
<blockquote>
<ul>
<li>写业务逻辑代码（例如 es6，scss，pug 等）</li>
<li>处理成浏览器认识的（js，css，html）</li>
<li>浏览器自动刷新看到效果</li>
</ul>
</blockquote>
<p>前端开发就是在不断的 123..123..123…. 循环中进行的，上面的后两步（也就是 2 和 3）应该是 <strong>自动化</strong> 的，前端开发者理应只需关注第 1 步——写业务逻辑代码。</p>
<p>自动化的事情应该交由构建工具来做，时下流行的前端构建工具有 gulp 和 webpack（有人说 webpack 不算是构建工具，我觉得这没什么好争的。横看成岭侧成峰，我觉得从当前 webpack 所能做的事情来看，说它是构建工具丝毫不为过）。本文不会对 <a href="http://www.gulpjs.com.cn/" target="_blank" rel="noopener">gulp</a> 和 <a href="http://webpack.github.io/" target="_blank" rel="noopener">webpack</a> 的概念和内容做深入解析，而是希望从宏观的角度研究他们的优势短缺和适用场景，从而说清长期弥漫在前端圈二者之间扑朔迷离的关系。</p>
<p><strong>什么是构建工具</strong><br>构建工具是一段自动根据源代码生成可使用文件的程序，构建过程包括打包、编译、压缩、测试等一切需要对源代码进行的相关处理。构建工具的目的是实现构建过程的自动化，使用它可以让咱们避免机械重复的劳动（这怕是程序员最不能忍受的了），从而解放我们的双手。</p>
<p><strong>解放了双手干什么</strong><br>哇槽，爱干什么干什么。</p>
<h1 id="Gulp-为何物"><a href="#Gulp-为何物" class="headerlink" title="Gulp 为何物"></a>Gulp 为何物</h1><p>先来听听 Ta 的官网是怎么说：</p>
<p>Gulp 致力于 <strong>自动化和优化</strong> 你的工作流，它是一个自动化你开发工作中 <strong>痛苦又耗时任务</strong> 的工具包。</p>
<p>想一想咱们日常的开发工作中痛苦又耗时任务有哪些呢？</p>
<blockquote>
<ul>
<li>用 es6，typescript 编写的脚本文件需要编译成浏览器认识的 javascript</li>
<li>用 scss，less 编写的样式文件需要编译成浏览器认识的 css</li>
<li>检查代码是否符合书写规范，跑单元测试和集成测试</li>
<li>开发环境如果有 sourcemaps 的话调试起来就方便多了，修改完代码浏览器能自动刷新立即看到效果就更好了</li>
<li>生产环境部署代码需要压缩合并静态文件，添加文件指纹控制缓存</li>
<li>blabla…更多的你自己想吧</li>
</ul>
</blockquote>
<p><strong>Gulp</strong> 声称要帮咱们实现 <strong>自动化</strong>，那他是怎样帮助咱们实现自动化的呢？这就不得不先提一嘴牛逼哄哄的 <strong>NodeJS</strong>。</p>
<p>Node 背景小知识</p>
<blockquote>
<p>Node 使前端 Jser 有了脱离浏览器工作的能力，要搁以前的话咱们写的 js 要么嵌到 html 页面里，然后用浏览器打开 html 页面才能运行js，要么就是在浏览器开发者工具的 Console 面板里编写运行代码片段。总之没了浏览器这个宿主，咱们的 js 就 run 不起来。Node 这货突发奇想，把开发者工具的 Console 给抠下来了，从此 js 可以脱离浏览器直接在 node 里运行。<strong>相当于 js 现在有了两个宿主环境，一个是浏览器，一个是 node</strong>。当然了，Node 可不是开发者工具里的 Console，那只是打个比方。它是基于Chrome V8 引擎实现的一个 JavaScript 运行环境，功能其实类似 Console 面板，但提供了大量实用的 API，感兴趣的同学可前往 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node官网</a> 详细了解，英文吃力的骚年 <a href="http://nodejs.cn/" target="_blank" rel="noopener">戳这里</a>。Node 可以算是前端革命式的创新，随 node 一起发布的 node 包管理器 npm(node package manager) 也已经是全球最大的开源库生态系统。node/npm 这对组合一出，前端生态迎来了大爆发，一时间为解决各种问题的 node 包层出不穷，遍地开花。gulp 就是披荆斩棘，一路过五关斩六将闯出来的一个小 node 包。</p>
</blockquote>
<p>扯谈完毕，接下来就来看看 <strong>gulp</strong> 是不是在装逼，他到底能不能帮我们实现自动化。</p>
<p>作为一个 node 包，标准打开方式当然是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g gulp</span><br></pre></td></tr></table></figure>

<p>然后呢，这里以编译 less 为例，首先安装编译 less 需要用到的 node 包：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev gulp gulp-less</span><br></pre></td></tr></table></figure>

<p><strong>前面已经全局安装过 gulp 了，怎么又本地安装了一遍</strong><br>前面的 <code>-g</code> 是全局安装，是为了执行你所编写的 gulp 任务，即 gulp yourTask。而后面的 –save-dev 是本地安装，是为了咱们编写任务时使用 gulp 提供的 api，例如 <code>gulp.src()</code>、<code>gulp.task()</code>、<code>gulp.dest()</code> 等等。当然也是可以直接使用全局安装的 gulp 的 api 的，但是强烈不推荐，因为这样涉及到 gulp 版本控制的问题，而且使用全局 gulp 的 api 的话就会产生环境依赖（你假设环境已经全局安装了gulp，万一没装呢，程序不就出错了）。</p>
<p>接着在项目的根目录下新建一个 <strong>gulpfile.js</strong> 文件，这是 gulp 的默认配置文件。</p>
<p><strong>gulpfile.js 必须放在项目根目录？</strong><br>当然也可放在其他目录，但这样的话就得在启动 gulp 任务时手动指定 gulp 配置文件 gulp yourTask –gulpfile yourGulpfilePath，可能还需要全局安装 gulp-cli，所以除非有特殊需要，否则就放在项目根目录就行了，这样最简单。</p>
<p><strong>配置文件的名字必须是 gulpfile.js 吗？</strong><br>不区分大小写，取成 gULPFile.js 的话 gulp 也能认识，只要 toLowerCase 之后是 gulpfile 就行了，如果取其它名字那你就又得使用 –gulpfile 选项去指定了。</p>
<p>现在工程目录结构已经成了下面的样子：</p>
<p><img src="/gulp-vs-webpack/1.png" alt="构建前 gulp 工程目录结构"></p>
<p>构建前 gulp 工程目录结构</p>
<p>接下来就是在 gulpfile.js 里编写 <strong>gulp task</strong>（gulp 把为每个痛苦又耗时任务编写的处理方法称为一个 <strong>task</strong>）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">const</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'build:less'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./src/*.less'</span>)</span><br><span class="line">        .pipe(less())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>最后就是打开一个终端，在终端里运行 gulp build:less。好了，编译后的文件已经被输出到了 <strong>dist</strong> 目录：</p>
<p><img src="/gulp-vs-webpack/2.png" alt="构建后 gulp 工程目录结构"></p>
<p>构建后 gulp 工程目录结构</p>
<p>至此你已经算是一个 gulp 砖家了，这基本上就是 gulp 的全部内容。怎么样，是不是够简单，够丝滑。这也是 gulp 的突出特点——易于学习，易于使用，五分钟成砖家。如果想要执行解决其他痛苦又耗时的任务，只需下载安装对应的 gulp 插件包，然后依次类推写一个 <code>gulp.task</code> 出来就行了。</p>
<p><strong>这些源代码具体是怎样被处理的</strong><br>这通常不需要关心，因为 gulp 插件包已为你做好了，并且封装的非常漂亮，你只需要告诉 gulp 你要什么，gulp 及其插件会帮你打点好一切。这就好比你把一份电子文档传进打印机，告诉它我要一份 A4 纸打印，呲呲呲~，打印机就吐出来一张 A4 纸，上面是你的文档内容。源代码就是你的电子文档，gulp 插件就是打印机，生成的可用文件就是你手里的那张 A4 纸，你不用关心打印机内部是怎样工作的，因为它封装的很好，或者你可以把打印机拆了一探究竟也行。</p>
<p><strong>Gulp 是基于流的？</strong><br>流（Stream）不是 gulp 创造的概念，而是从 unix 时代就开始使用的 I/O 机制，一直到现在仍在广泛使用。Node 封装了一个 <a href="http://nodejs.cn/api/stream.html" target="_blank" rel="noopener">stream</a> 模块专门用来对流进行操作。gulp 所基于的流即是 Node 封装起来的 stream。上面 <code>gulp.task()</code> 代码里面的 <a href="http://nodejs.cn/api/stream.html#stream_readable_pipe_destination_options" target="_blank" rel="noopener">pipe</a> 方法并不是 gulp 提供的 api，而是 node 的 api，准确的说应该是 node 的 stream 模块提供的 api。具体是怎么实现的呢：<code>gulp.src()</code> 的返回值是 node Stream 的一个实例，之后的 <code>pipe</code> 调用的其实是这个实例的 <code>pipe</code> 方法，而 <code>pipe</code> 方法的返回值依然是 node Stream 实例，以此实现前面的 <code>.pipe().pipe().pipe()</code> 这种串联写法。熟悉 jQuery 的同学应该很清楚这种技巧。</p>
<h1 id="webpack-又是从哪冒出来的"><a href="#webpack-又是从哪冒出来的" class="headerlink" title="webpack 又是从哪冒出来的"></a>webpack 又是从哪冒出来的</h1><p>gulp 似乎是完美的，对前端开发工作中每一项痛苦又耗时任务都能见招拆招，各个击破。然而前端发展速度之快超乎想象，对页面性能和用户体验更是追求极致，以至于 gulp 某些领域尤其大型 <strong>SPA</strong>（单页应用）显得有些不够用了：</p>
<blockquote>
<ul>
<li>单页应用的核心是模块化，ES6 之前 JavaScript 语言本身一直是没有模块系统的，导致 AMD，CMD，UMD 各种轮子模块化方案都蹦出来。对这种模块化乱象，gulp 显得无能为力，gulp 插件对这一块也没有什么想法。不过也可以理解，模块化解决方案可不是谁都能 hold 住的，需要考虑的问题太多了；</li>
<li>对前沿的 SPA 技术 gulp 处理起来显得有些力不从心，例如 Vue 的单文件组件，gulp 配合一些插件可以勉强处理，但是很蹩脚。其实归根结底，还是模块化处理方面的不足；</li>
<li>优化页面加载速度的一条重要法则就是减少 http 请求。gulp 只是对静态资源做流式处理，处理之后并未做有效的优化整合，也就是说 gulp 忽略了系统层面的处理，这一块还有很大的优化空间，尤其是移动端，那才真的是一寸光阴一寸金啊，哪怕是几百毫秒的优化所带来的收益（用户？流量？付费？）绝对超乎你的想象。别跟我说 gulp-concat，CSS Sprites，这俩玩意儿小打小闹还行，遇上大型应用根本拿不上台面。现在的页面动辄上百个零碎资源（图片，样式表，脚本），也就是上百个 http 请求，因此这个优化需求还是相当迫切的。关于为何减少 http 请求可以有效降低页面加载时间<a href="http://www.cnblogs.com/iovec/p/7904416.html" target="_blank" rel="noopener">戳这里</a>。</li>
<li>blabla… 你自己想吧，主要就是大型单页应用方面有短板；</li>
</ul>
</blockquote>
<p>时势造英雄。webpack 一声吼，大张旗鼓地挖起了gulp 的墙角。</p>
<p>老规矩，先看看webpack官网怎么<del>吹牛逼</del>介绍自己的：</p>
<p><strong>Webpack</strong> 是当下最热门的前端资源模块化 <strong>管理和打包</strong> 工具。它可以将许多松散的模块按照依赖和规则打包成符合生产环境部署的前端资源。还可以将按需加载的模块进行代码分割，等到实际需要的时候再异步加载。</p>
<p>是不是看完一脸懵逼，不明觉厉。其实翻译过来就是 “在我眼里，什么都是模块”。webpack “万物皆模块” 的理念和 SPA 配合起来简直是金童玉女，天作之合。这也是 webpack 短时间内名声大噪，直接撼动 gulp 地位的主要原因。</p>
<p>webpack 的理念比较前卫，它本身也带来了很多新的概念和内容，诸如加载器（loader）、依赖图（Dependency Graph）等等。和 gulp 两小时成砖家的学习难度相比，webpack 或许你研究两天仍然会晕头转向。</p>
<p>接下来简单看一下 webpack 的主要工作方式。</p>
<p>webpack 和 gulp 一样也是一个小 node 包，打开方式自然是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -g webpack</span><br><span class="line">npm i --save-dev webpack</span><br></pre></td></tr></table></figure>

<p>和 gulp 一样，全局安装是为了执行 webpack 任务，本地安装是为了使用 webpack 提供的 api。</p>
<p>安装完 webpack 之后在项目根目录下新建一个 <strong>webpack.config.js</strong>，这是 webpack 的默认配置文件，同 gulp 的 gulpfile.js 的功能类似。webpack.config.js 同样是不区分大小写的，取成 webPACk.CONfig.js 的话 webpack 也能认识，但是取成其他名字或放在别的目录就需要使用 –config 选项去指定配置文件了。</p>
<p>现在工程目录结构如下：</p>
<p><img src="/gulp-vs-webpack/3.png" alt="构建前webpack工程目录结构"></p>
<p>构建前webpack工程目录结构</p>
<p>接下来就是在 webpack.config.js 里配置需要的选项，注意了，webpack 与 gulp 的重要不同就是使用方式 <strong>由编程式变成了配置式</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,        <span class="comment">// 告诉 webpack 你要编译哪个文件</span></span><br><span class="line">    output: &#123;                       <span class="comment">// 告诉 webpack 你要把编译后生成的文件放在哪</span></span><br><span class="line">        filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">        path: path.join(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>最后仍然和 gulp 类似，就是在终端里运行 webpack（终端里一般会出现一大坨编译信息）。好了，现在 webpack 已经把编译好的文件输出到了 dist 目录：</p>
<p><img src="/gulp-vs-webpack/4.png" alt="构建后webpack工程目录结构"></p>
<p>构建后webpack工程目录结构</p>
<p>看到这是不是已经一头雾水了，在你还没明白发生了什么的时候 webpack 已经把事情干完了。这也是 webpack 和 gulp 作业方式的重要不同：<strong>Gulp</strong> 是搭了个台子，让 gulp 插件在上面唱戏，尽情表演，所有构建相关的具体事情都交由 gulp 插件去做。而 <strong>Webpack</strong> 就牛逼了，webpack 先搭了个台子，然后自己在上面唱嗨了，仔细一听，他在上面唱的是《我们不一样》，当然了他也是让 webpack 插件在上面唱戏的。</p>
<p>也就是说 webpack 把很多功能都封装进了自己身体里面，使得自己强大同时臃肿。现在你可以在 <code>./src/index.js</code> 文件里直接写 ES6 代码，因为 webpack 把编译 ES6 的工作已经封装到自己的实现里了，使得 webpack 看起来原生支持 ES6 而不需要借助第三方插件，其实他内部也是用了第三方插件的，所以你不用再专门去下一个 babel 之类的插件去转译 ES6。这样封装的好处是使用起来很方便，不好的地方就是使用者完全不知道发生了什么，构建完了还一脸懵逼。</p>
<p>上面仅是 webpack 使用的最最最简单示例，简直连 “hello world” 都算不上。具体怎样打包各种资源（typescript，样式表，图片，字体等等）可前往 <a href="http://webpack.github.io/" target="_blank" rel="noopener">webpack官网</a> 深入学习，想看中文的同学使劲 <a href="http://www.css88.com/doc/webpack/" target="_blank" rel="noopener">戳这里</a>。</p>
<p>webpack “一切皆模块” 的特点完美解决了上面 gulp 暴露的几个短板，连 webpack 官网也说自己是因为看到现存的模块打包器都不太适合大型 SPA 应用，于是决定打造一个适合大型 SPA 应用的模块打包器，也就是说 <a href="http://webpack.github.io/docs/what-is-webpack.html" target="_blank" rel="noopener">webpack 其实就是为大型 SPA 而生的</a>。</p>
<p><strong>webpack 怎么实现像 gulp 一样对大量源文件进行流式处理</strong><br>人家 webpack 本来就没打算做这事。webpack 不是以取代 gulp 为目的的，而是为了给大型 SPA 提供更好的构建方案。对大量源文件进行流式处理是 gulp 擅长的事，webpack 不想抢，也没必要抢。即使抢，也无非是再造一个蹩脚的 gulp 出来而已。</p>
<p><strong>既然 webpack 模块化这么强，那以后模块化就全用 webpack 好了</strong><br>webpack 模块化是强，但是他胖啊，不是所有人都抱得动，主要是他为了提供更多的功能封装进了太多东西，所以选择上还是需要因地制宜。如果单纯只是打包 js（多页应用往往是这种需求），完全可以使用 rollup，browserify 这种小而美的实现，因为他们只做一件事——打包js。而如果需要将图片，样式，字体等所有静态资源全部打包，webpack 毫无疑问是首选。这也是为什么越来越多的流行库和框架开始从 webpack 转向使用 rollup 进行打包，因为他们只需要打包 js，webpack 好多强大功能根本用不到。连 rollup 官网也坦言如果你在构建一个库，rollup 绝对是首选，但如果是构建一个应用，那么请选 webpack。</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>我看好多人说 gulp 和 webpack 不是一类东西，我不这么觉得，虽然说两者的出发点确实是不一样的，gulp 走的是流式处理路线，webpack 走的是模块处理路线，但是两者所要达成的目标却是一样的，那就是<strong>促进前端领域的自动化和工程化管理</strong>。webpack 发展到现在，已经非常强大了，强大到在构建方面 gulp 能做的事 webpack 基本上都可以胜任，gulp 做不了的 webpack 也能搞。同样的那些开发工作中痛苦又耗时的任务，gulp 和 webpack 都能解决，只是解决思路有天壤之别。</p>
<p>下表是从各个角度对 gulp 和 webpack 做的对比：</p>
<table>
<thead>
<tr>
<th></th>
<th>Gulp</th>
<th>Webpack</th>
</tr>
</thead>
<tbody><tr>
<td>定位</td>
<td>基于流的自动化构建工具</td>
<td>一个万能模块打包器</td>
</tr>
<tr>
<td>目标</td>
<td>自动化和优化开发工作流，为通用 website 开发而生</td>
<td>通用模块打包加载器，为移动端大型 SPA 应用而生</td>
</tr>
<tr>
<td>学习难度</td>
<td>易于学习，易于使用，api总共只有5个方法</td>
<td>有大量新的概念和api，不过好在有详尽的官方文档</td>
</tr>
<tr>
<td>适用场景</td>
<td>基于流的作业方式适合多页面应用开发</td>
<td>一切皆模块的特点适合单页面应用开发</td>
</tr>
<tr>
<td>作业方式</td>
<td>对输入（gulp.src）的 js，ts，scss，less 等源文件依次执行打包（bundle）、编译（compile）、压缩、重命名等处理后输出（gulp.dest）到指定目录中去，为了构建而打包</td>
<td>对入口文件（entry）递归解析生成依赖关系图，然后将所有依赖打包在一起，在打包之前会将所有依赖转译成可打包的 js 模块，为了打包而构建</td>
</tr>
<tr>
<td>使用方式</td>
<td>常规 js 开发，编写一系列构建任务（task）。</td>
<td>编辑各种 JSON 配置项</td>
</tr>
<tr>
<td>优点</td>
<td>适合多页面开发，易于学习，易于使用，接口优雅。</td>
<td>可以打包一切资源，适配各种模块系统</td>
</tr>
<tr>
<td>缺点</td>
<td>在单页面应用方面输出乏力，而且对流行的单页技术有些难以处理（比如 Vue 单文件组件，使用 gulp 处理就会很困难，而 webpack 一个 loader 就能轻松搞定）</td>
<td>不适合多页应用开发，灵活度高但同时配置很繁琐复杂。“打包一切” 这个优点对于 HTTP/1.1 尤其重要，因为所有资源打包在一起能明显减少浏览器访问页面时的资源请求数量，从而减少应用程序必须等待的时间。但这个优点可能会随着 HTTP/2 的流行而变得不那么突出，因为 HTTP/2 的多路复用可以有效解决客户端并行请求时的瓶颈问题。</td>
</tr>
<tr>
<td>结论</td>
<td>浏览器多页应用(MPA)首选方案</td>
<td>浏览器单页应用(SPA)首选方案</td>
</tr>
</tbody></table>
<p><strong>gulp 为何不吸取百家之长，把 webpack 的东西集成进来，反正都是开源的</strong><br>腾讯那么牛逼，你说他怎么不把阿里巴巴集成进来。集成应该是没可能，因为 gulp 和 webpack 的定位不一样。所以，没有放之天下而皆准的解决方案，只有具体问题具体分析选择适合的解决方案才能正确地解决问题。gulp 和 webpack 只是我们解决问题的工具，不要被工具束缚了手脚不能前进。</p>
<p><strong>扯了这么多，到底谁会被拍死在沙滩上</strong><br>可以看出来，这两个工具其实各有优缺，都有用武之地。合理地配合使用，取长补短，才能发挥最大的威力，所以这俩基友并不是互斥的，而是互补的，谁也不会被拍死在沙滩上。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/12/03/gulp-vs-webpack/" data-id="cka5femkn002mgbu41nru036x" class="article-share-link" data-share="baidu" data-title="前端构建工具之争——Webpack vs Gulp 谁会被拍死在沙滩上">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Frontend/" rel="tag">Frontend</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-observer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/27/observer/" class="article-date">
  <time datetime="2018-11-27T14:17:35.000Z" itemprop="datePublished">2018-11-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/27/observer/">行为型模式-观察者模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>观察者模式</strong>，也称<strong>发布-订阅模式</strong>，定义了一个被观察者和多个观察者的、一对多的对象关系。</p>
<p>在被观察者状态发生变化的时候，它的所有观察者都会收到通知，并自动更新。</p>
<p>观察者模式通常用在<strong>实时事件处理系统、组件间解耦、数据库驱动的消息队列系统</strong>，同时也是<strong>MVC设计模式中的重要组成部分</strong>。</p>
<p>以下我们以订单创建为例。</p>
<p>当订单创建后，系统会<strong>发送邮件</strong>和<strong>短信</strong>，并保存<strong>日志记录</strong>。</p>
<h2 id="1-问题"><a href="#1-问题" class="headerlink" title="1 问题"></a>1 问题</h2><p>在没有用观察者模式的时候，如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 订单状态</span></span><br><span class="line">    <span class="keyword">private</span> $state = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 订单状态有变化时发送通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addOrder</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 发送邮件</span></span><br><span class="line">        Email::update(<span class="keyword">$this</span>-&gt;state);</span><br><span class="line">        <span class="comment">// 短信通知</span></span><br><span class="line">        Message::update(<span class="keyword">$this</span>-&gt;state);</span><br><span class="line">        <span class="comment">// 记录日志</span></span><br><span class="line">        Log::update();</span><br><span class="line">        <span class="comment">// 其他更多通知</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码中，在<code>Order</code>类中调用各类的方法来实现通知。当在客户端创建订单：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$order = <span class="keyword">new</span> Order();</span><br><span class="line">$order-&gt;addOrder();</span><br></pre></td></tr></table></figure>

<p>就会同时产生三个通知：发送邮件、发送短信和记录日志。</p>
<p>在系统小的时候，这是非常快捷有效的方式。</p>
<p>可是，当系统变大的时候，这种方法马上面临难以扩展的问题，并且容易出错：</p>
<ol>
<li>如果订单不需要某种通知，比如不需要记录日志，则必须修改<code>Order</code>类，做状态的判断；</li>
<li>如果再加一种通知方式，如系统消息通知，则除了增加新类，同时还需要修改<code>Order</code>类和客户端。</li>
</ol>
<p>这两条都不符合面向对象中的<strong>开闭原则</strong>，会让系统越来越难维护。</p>
<h2 id="2-解决"><a href="#2-解决" class="headerlink" title="2 解决"></a>2 解决</h2><p>接下来我们用观察者模式解决这个问题。</p>
<h3 id="2-1-被观察者"><a href="#2-1-被观察者" class="headerlink" title="2.1 被观察者"></a>2.1 被观察者</h3><p>被观察者是一些具体的实例，比如订单管理、用户登陆、评论回复、状态审核等等。</p>
<p>别的功能会依赖于它们的状态进行各种动作。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 被观察者接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 添加/注册观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span><span class="params">(Observer $observer)</span></span>;</span><br><span class="line">    <span class="comment">// 删除观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span><span class="params">(Observer $observer)</span></span>;</span><br><span class="line">    <span class="comment">// 触发通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 被观察者</span></span><br><span class="line"><span class="comment"> * 职责：添加观察者到$observers属性中，</span></span><br><span class="line"><span class="comment"> * 有变动时通过notify()方法运行通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">implements</span> <span class="title">Observable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 保存观察者</span></span><br><span class="line">    <span class="keyword">private</span> $observers = <span class="keyword">array</span>();</span><br><span class="line">    <span class="comment">// 订单状态</span></span><br><span class="line">    <span class="keyword">private</span> $state = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加（注册）观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span><span class="params">(Observer $observer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $key = array_search($observer, <span class="keyword">$this</span>-&gt;observers);</span><br><span class="line">        <span class="keyword">if</span> ($key === <span class="keyword">false</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;observers[] = $observer;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移除观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span><span class="params">(Observer $observer)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $key = array_search($observer, <span class="keyword">$this</span>-&gt;observers);</span><br><span class="line">        <span class="keyword">if</span> ($key !== <span class="keyword">false</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;observers[$key]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历调用观察者的update()方法进行通知，不关心其具体实现方式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;observers <span class="keyword">as</span> $observer) &#123;</span><br><span class="line">            <span class="comment">// 把本类对象传给观察者，以便观察者获取当前类对象的信息</span></span><br><span class="line">            $observer-&gt;update(<span class="keyword">$this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 订单状态有变化时发送通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addOrder</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;notify();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取提供给观察者的状态</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getState</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>被观察者至少要实现<code>attach()</code>、<code>detach()</code>、<code>notify()</code>三个方法，用以添加、删除和通知观察者。</p>
<p>通知的方式是，在类中的其他方法（如：创建订单）调用<code>notify()</code>方法。</p>
<p>另外，观察者可能用到被观察者的一些状态信息。</p>
<p>所以，要在<code>notify()</code>中把当前对象作为参数传给观察者，方便其通过提供的<code>public</code>方法获得被观察者的状态信息。</p>
<p>本例用<code>getState()</code>方法供给观察者获取状态信息。</p>
<h3 id="2-2-观察者"><a href="#2-2-观察者" class="headerlink" title="2.2 观察者"></a>2.2 观察者</h3><p>观察者可能有多个，但每个观察者都必须实现<code>Observer</code>接口规定的<code>update()</code>方法，这是接收被观察者通知的唯一渠道。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 接收到通知的处理方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(Observable $observable)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者1：发送邮件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(Observable $observable)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $state = $observable-&gt;getState();</span><br><span class="line">        <span class="keyword">if</span> ($state) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'发送邮件：您已经成功下单。'</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'发送邮件：下单失败，请重试。'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者2：短信通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Message</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(Observable $observable)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $state = $observable-&gt;getState();</span><br><span class="line">        <span class="keyword">if</span> ($state) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'短信通知：您已下单成功。'</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'短信通知：下单失败，请重试。'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者3：记录日志</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Log</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(Observable $observable)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'记录日志：生成了一个订单记录。'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里有三个观察者：<strong>发送邮件</strong>、<strong>短信通知</strong>和<strong>记录日志</strong>，它们都实现了<code>update()</code>方法。</p>
<p>其中，发送邮件和短信依赖于订单、也就是被观察者的状态，来决定发送消息的内容，记录日志则不需要订单的状态。</p>
<h3 id="2-3-客户端"><a href="#2-3-客户端" class="headerlink" title="2.3 客户端"></a>2.3 客户端</h3><p>然后我们创建一个客户端，内容：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建观察者对象</span></span><br><span class="line">$email = <span class="keyword">new</span> Email();</span><br><span class="line">$message = <span class="keyword">new</span> Message();</span><br><span class="line">$log = <span class="keyword">new</span> Log();</span><br><span class="line"><span class="comment">// 创建订单对象</span></span><br><span class="line">$order = <span class="keyword">new</span> Order();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向订单对象中注册3个观察者：发送邮件、短信通知、记录日志</span></span><br><span class="line">$order-&gt;attach($email);</span><br><span class="line">$order-&gt;attach($message);</span><br><span class="line">$order-&gt;attach($log);</span><br><span class="line"><span class="comment">// 添加订单，添加时会自动发送通知给观察者</span></span><br><span class="line">$order-&gt;addOrder();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br /&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除记录日志观察者</span></span><br><span class="line">$order-&gt;detach($log);</span><br><span class="line"><span class="comment">// 添加另一个订单，会再次发送通知给观察着</span></span><br><span class="line">$order-&gt;addOrder();</span><br></pre></td></tr></table></figure>

<p>执行应用后，会输出这样的消息：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">发送邮件：您已经成功下单。添加日志：生成了一个订单记录。系统消息：您已下单成功。</span><br><span class="line">发送邮件：您已经成功下单。添加日志：生成了一个订单记录。</span><br></pre></td></tr></table></figure>

<p>对于不需要通知的观察者，用<code>detach()</code>移出观察者列表即可。</p>
<p>这种情况就解开了类之间的耦合。</p>
<h3 id="2-4-新增观察者"><a href="#2-4-新增观察者" class="headerlink" title="2.4 新增观察者"></a>2.4 新增观察者</h3><p>如果再需要新增一个观察者，如下，只需要添加观察者类本身，实现<code>update()</code>方法。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者4：系统消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Alert</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(Observable $observable)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'系统消息：您的订单有更新了~~~'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再到客户端中注册<code>Alert</code>类到观察者列表中：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建“系统消息”观察者</span></span><br><span class="line">$alert = <span class="keyword">new</span> Alert();</span><br><span class="line"><span class="comment">// 注册观察者到订单对象中</span></span><br><span class="line">$order-&gt;attach($alert);</span><br></pre></td></tr></table></figure>

<p>就能订阅被观察者的通知。</p>
<h2 id="3-特点"><a href="#3-特点" class="headerlink" title="3 特点"></a>3 特点</h2><p>在观察者模式中，<strong>被观察者完全不需要关心观察者</strong>，在自身状态有变化是，遍历执行观察者<code>update()</code>方法即完成通知。</p>
<p>在观察者模式中，被观察者通过添加<code>attach()</code>方法，提供给观察者注册，使自己变得可见。</p>
<p>当被观察者改变时，给注册的观察者发送通知。至于观察者如何处理通知，被观察者不需要关心。</p>
<p>这是一种良好的设计，对象之间不必相互理解，同样能够相互通信。</p>
<p>UML如下：</p>
<p><img src="img/201811/observerable.png" alt="img"></p>
<p>面向对象编程中，任何对象的状态都非常重要，它们是对象间交互的桥梁。</p>
<p>当一个对象的改变需要被其他对象关注时，观察者模式就派上用场了。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/11/27/observer/" data-id="cka5feml20043gbu40slra6y6" class="article-share-link" data-share="baidu" data-title="行为型模式-观察者模式">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-simple-factory" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/27/simple-factory/" class="article-date">
  <time datetime="2018-11-27T14:12:40.000Z" itemprop="datePublished">2018-11-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/27/simple-factory/">简单工厂模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>工厂模式，就是负责生成其他对象的类或方法。</p>
<h2 id="1-类实现"><a href="#1-类实现" class="headerlink" title="1 类实现"></a>1 类实现</h2><p>比如，我们有一些类，它们都继承自交通工具类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'汽车靠四个轮子滚动行走。'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ship</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'轮船靠螺旋桨划水前进。'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aircraft</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'飞机靠螺旋桨和机翼的升力飞行。'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再创建一个工厂类，专门用作类的创建，：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VehicleFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span><span class="params">($className = null)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $className = ucfirst($className);</span><br><span class="line">        <span class="keyword">if</span> ($className &amp;&amp; class_exists($className)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> $className();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>工厂类用了一个静态方法来创建其他类，在客户端中就可以这样使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">VehicleFactory::build(<span class="string">'Car'</span>)-&gt;drive();</span><br><span class="line">VehicleFactory::build(<span class="string">'Ship'</span>)-&gt;drive();</span><br><span class="line">VehicleFactory::build(<span class="string">'Aircraft'</span>)-&gt;drive();</span><br></pre></td></tr></table></figure>

<p>省去了每次都要<code>new</code>类的工作。</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2>
      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/11/27/simple-factory/" data-id="cka5femll005qgbu437w4d36d" class="article-share-link" data-share="baidu" data-title="简单工厂模式">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-php-design-patterns-basic" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/php-design-patterns-basic/" class="article-date">
  <time datetime="2018-11-26T06:40:55.000Z" itemprop="datePublished">2018-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/php-design-patterns-basic/">PHP 设计模式基础2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>设计模式的宗旨就是：<strong>重用</strong>。</p>
<p>在面向对象中，类是用于生成对象的代码模版，而设计模式是用于解决共性问题的代码模版。</p>
<p>遵循这样的模板，我们可以设快速地设计出优秀的代码。</p>
<p>注意，设计模式只是模板，不是具体的代码。</p>
<p>它是为了<strong>代码复用，增加可维护性</strong>。</p>
<p>在学习设计模式的时候，有几个概念让我很难接受，这可能是从过程式编程转到面向对象编程的禁锢。</p>
<p>假设有这样一个对象：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $name = <span class="string">'Human'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-变量保存对象"><a href="#1-变量保存对象" class="headerlink" title="1 变量保存对象"></a>1 变量保存对象</h2><p>不要觉得变量只能保存整形数字，数组和字符串，变量还可以保存对象的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$man = <span class="keyword">new</span> Person;</span><br><span class="line"><span class="keyword">echo</span> $man-&gt;getName();</span><br></pre></td></tr></table></figure>

<h2 id="2-传递对象参数"><a href="#2-传递对象参数" class="headerlink" title="2 传递对象参数"></a>2 传递对象参数</h2><p>如果另一个类用到了Person类的属性或方法，那直接穿进去就可以了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($person)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $person-&gt;getName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传递对象，最后输出字符串“Human”</span></span><br><span class="line">$jack = <span class="keyword">new</span> Student(<span class="keyword">new</span> Person);</span><br></pre></td></tr></table></figure>

<p>但是这样有一个小问题，当传递给<code>new Student()</code>不是一个<code>Person</code>对象时，如下，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$jack = <span class="keyword">new</span> Student(<span class="string">'abc'</span>);</span><br></pre></td></tr></table></figure>

<p>程序就会报错。于是有了第三种做法，限定参数的类型。</p>
<h2 id="3-限定传递参数的类型"><a href="#3-限定传递参数的类型" class="headerlink" title="3 限定传递参数的类型"></a>3 限定传递参数的类型</h2><p>在传递参数的时候，就限定参数的类型，这样写：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Person $person)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> $person-&gt;getName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传递对象，</span></span><br><span class="line">$jack = <span class="keyword">new</span> Student(<span class="keyword">new</span> Person);</span><br></pre></td></tr></table></figure>

<p>这样，传给<code>new Student()</code>的参数必须是<code>Person</code>的实例。</p>
<h2 id="4-用类属性保存对象"><a href="#4-用类属性保存对象" class="headerlink" title="4 用类属性保存对象"></a>4 用类属性保存对象</h2><p>还有一种经常用到的做法，就是用一个类的属性保存对象或对象集合。如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Life</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $persons = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addPerson</span><span class="params">(Person $person)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;persons[] = $person;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$class = <span class="keyword">new</span> Life();</span><br><span class="line">$class-&gt;addPerson(<span class="keyword">new</span> Person);</span><br><span class="line">$class-&gt;addPerson(<span class="keyword">new</span> Person);</span><br><span class="line"></span><br><span class="line">var_dump($class-&gt;persons);</span><br></pre></td></tr></table></figure>

<p>输出值：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  object(Person)<span class="comment">#2 (1) &#123;</span></span><br><span class="line">    [<span class="string">"name"</span>:<span class="string">"Person"</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">    string(<span class="number">5</span>) <span class="string">"Human"</span></span><br><span class="line">  &#125;</span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  object(Person)<span class="comment">#3 (1) &#123;</span></span><br><span class="line">    [<span class="string">"name"</span>:<span class="string">"Person"</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">    string(<span class="number">5</span>) <span class="string">"Human"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-小结"><a href="#5-小结" class="headerlink" title="5 小结"></a>5 小结</h2><p>面向对象的设计模式都是围绕上面的情形，做一些组合之后形成的。</p>
<p>所以，理解类之间关系才是重点。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/11/26/php-design-patterns-basic/" data-id="cka5feml5004hgbu4ccq6b6mv" class="article-share-link" data-share="baidu" data-title="PHP 设计模式基础2">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Design-Pattern/" rel="tag">Design Pattern</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-php-design-patterns-introduction" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/php-design-patterns-introduction/" class="article-date">
  <time datetime="2018-11-26T06:29:29.000Z" itemprop="datePublished">2018-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/php-design-patterns-introduction/">PHP 设计模式基础1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>面向对象</strong>是PHP5之后增加的功能，是PHP走向现代语言的一个标志。</p>
<p>在过程式设计时代，PHP以学习<strong>成本低、入门快</strong>的特点赢得很多WEB开发者的青睐，但同时也限制了PHP的发展。</p>
<p>借鉴Java和C++之后的PHP语言，在增加面向对象特性的同时，还保持着简便易懂的特点。</p>
<p>但是，如果<strong>只是使用了PHP的继承特性，并不是面向对象的设计</strong>，因为这并不能提高代码的<strong>重用性</strong>和<strong>灵活性</strong>。</p>
<p> 不论是 PHP、Java还是C++编程语言，在编程的时候，我们所遇到的大部分问题，其实<strong>都已经被其他程序员一再的处理</strong>了。</p>
<p>设计模式提取了共同问题，定义了经过测试的解决方案，并描述了可能的结果。</p>
<p>也就是说，设计模式（Patterns）是<strong>一些可以在项目中重复使用的解决方案</strong>。</p>
<p>但是，设计模式并非像组件那样，能被合并来构建系统的固定的解决方案，它们是<strong>解决一般性问题的通用方法</strong>。</p>
<p>通俗来说，设计模式就是一些<strong>编程的套路</strong>，不是具体的攻防动作，是为设计更好系统设计的解决方案。</p>
<p> 面向对象的原则是“<strong>组合优于继承</strong>”，因为组合可以<strong>以多种方式动态的</strong>处理任务。</p>
<p>虽然对象的组合会导致代码的可读性下降，但会让系统<strong>更加灵活，复用性更高</strong>。</p>
<p><strong>设计模式</strong>是很多前辈花费大量精力<strong>总结的经验</strong>，是经过检验的高效的一系列对象组合方式。</p>
<p> 市面上的设计模式介绍大部分是Java语言，本文特地整理一份<strong>PHP版的设计模式</strong>。</p>
<h3 id="共12种经典的设计模式："><a href="#共12种经典的设计模式：" class="headerlink" title="共12种经典的设计模式："></a>共12种经典的设计模式：</h3><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><ul>
<li>UML 类图</li>
<li>设计原则<h4 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h4></li>
<li>简单工厂模式</li>
<li>工厂模式</li>
<li>抽象工厂模式</li>
<li>单例模式<h4 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h4></li>
<li>适配器模式</li>
<li>组合模式</li>
<li>外观模式</li>
<li>代理模式<h4 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h4></li>
<li>命令模式</li>
<li>迭代器模式</li>
<li>策略模式</li>
<li>观察者模式<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tinywind.cn/2018/11/26/php-design-patterns-introduction/" data-id="cka5feml6004ngbu49h39227z" class="article-share-link" data-share="baidu" data-title="PHP 设计模式基础1">分享到</a>
      

      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Design-Pattern/" rel="tag">Design Pattern</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/3/">下一页 &amp;raquo;</a>
  </nav>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/OOP/">OOP</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">PHP最佳实践</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ROBOTC/">ROBOTC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB%E5%BC%80%E5%8F%91/">WEB开发</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/phalcon/">phalcon</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/phalcon/WEB%E5%BC%80%E5%8F%91/">WEB开发</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1/">产品设计</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/">前端技术</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/">版本管理</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Database/" rel="tag">Database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Pattern/" rel="tag">Design Pattern</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Development/" rel="tag">Development</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ERP%E7%B3%BB%E7%BB%9F/" rel="tag">ERP系统</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/" rel="tag">English</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Frontend/" rel="tag">Frontend</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IE%E5%85%BC%E5%AE%B9/" rel="tag">IE兼容</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Laravel/" rel="tag">Laravel</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OOP/" rel="tag">OOP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming-paradigm/" rel="tag">Programming paradigm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROBOTC/" rel="tag">ROBOTC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/" rel="tag">SEO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/" rel="tag">database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/development/" rel="tag">development</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/laravel/" rel="tag">laravel</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stdClass-to-array/" rel="tag">stdClass to array</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ttfb/" rel="tag">ttfb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B9%90%E5%8D%9A%E5%A3%AB/" rel="tag">乐博士</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E6%96%87/" rel="tag">杂文</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F/" rel="tag">编程范式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a><span class="tag-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Database/" style="font-size: 10px;">Database</a> <a href="/tags/Design-Pattern/" style="font-size: 15px;">Design Pattern</a> <a href="/tags/Development/" style="font-size: 10px;">Development</a> <a href="/tags/ERP%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">ERP系统</a> <a href="/tags/English/" style="font-size: 10px;">English</a> <a href="/tags/Frontend/" style="font-size: 10px;">Frontend</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/IE%E5%85%BC%E5%AE%B9/" style="font-size: 10px;">IE兼容</a> <a href="/tags/Laravel/" style="font-size: 15px;">Laravel</a> <a href="/tags/OOP/" style="font-size: 10px;">OOP</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/Programming-paradigm/" style="font-size: 10px;">Programming paradigm</a> <a href="/tags/ROBOTC/" style="font-size: 10px;">ROBOTC</a> <a href="/tags/SEO/" style="font-size: 10px;">SEO</a> <a href="/tags/database/" style="font-size: 10px;">database</a> <a href="/tags/development/" style="font-size: 10px;">development</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/laravel/" style="font-size: 15px;">laravel</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/stdClass-to-array/" style="font-size: 10px;">stdClass to array</a> <a href="/tags/ttfb/" style="font-size: 10px;">ttfb</a> <a href="/tags/%E4%B9%90%E5%8D%9A%E5%A3%AB/" style="font-size: 10px;">乐博士</a> <a href="/tags/%E6%9D%82%E6%96%87/" style="font-size: 10px;">杂文</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 10px;">杂谈</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F/" style="font-size: 10px;">编程范式</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 20px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">8</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/09/10/n-plus-one-problem/">N+1问题的产生及解决</a>
          </li>
        
          <li>
            <a href="/2020/06/19/php-json-web-token/">JWT的PHP实现过程</a>
          </li>
        
          <li>
            <a href="/2020/05/26/auto-deploy-with-webhook/">通过GitHub的Webhook 实现推送的自动更新</a>
          </li>
        
          <li>
            <a href="/2020/05/26/upgrade-php-version/">Ubuntu升级PHP到最新版本</a>
          </li>
        
          <li>
            <a href="/2020/05/13/update-node-to-latest/">升级更新 node 版本</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://tinywind.cn" target="_blank">vex中文社区</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Nathan<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>





<script src="/js/script.js"></script>


</div>
</body>
</html>
